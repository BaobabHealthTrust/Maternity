Script started on Wed 13 Sep 2017 12:48:12 PM CAT
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/console
Loading development environment (Rails 2.3.5)
>>  raise PatientIdentifierType.find_by_name("National id").id.inspect[K[K[K[K[K[K[K[K[K[Kid[1P[1P[1P[1P[1P[1P
=> 3
>> ^C^C
>> 
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/console[9Pgeditcd ..node app.js[6Pcd ..geditscript/console[Kscript/console[9Pgeditcd ..node app.js[3Pifconfignode app.js[6Pcd ..geditscript/console[Kscript/console[9Pgeditcd ..node app.js[3Pifconfigvim app.js node app.js[K[K[K[K[K[K[K[K[K[K[Kscriot/server[1Pt/serverpt/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 12:49:39] INFO  WEBrick 1.3.1
[2017-09-13 12:49:39] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 12:49:39] INFO  WEBrick::HTTPServer#start: pid=8180 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:49:41) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.3ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1571:in `get_national_id'
  lib/patient_service.rb:1583:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.8ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:50:15) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) [0m

RuntimeError ([#<PatientIdentifier patient_id: 26, identifier: "P170000474733", identifier_type: 3, preferred: 0, location_id: 4, creator: 9, date_created: "2010-12-23 11:33:48", voided: false, voided_by: nil, date_voided: nil, void_reason: nil>]):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1584:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:50:48) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1583:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:50:53) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1583:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.5ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:51:21) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1584:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.2ms)
Rendered rescues/_request_and_response (0.3ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:51:36) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1584:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.1ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 12:51:42] INFO  going to shutdown ...
[2017-09-13 12:51:43] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 12:51:45] INFO  WEBrick 1.3.1
[2017-09-13 12:51:45] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 12:51:45] INFO  WEBrick::HTTPServer#start: pid=8387 port=3000
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:51:47) [GET]
  Parameters: {"identifier"=>"P170000474733", "action"=>"search", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1584:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.6ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 12:52:22] INFO  going to shutdown ...
[2017-09-13 12:52:22] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ [H[2J]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ ruby -v
ruby 1.8.7 (2013-06-27 patchlevel 374) [x86_64-linux]
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ r[Kscript/console
Loading development environment (Rails 2.3.5)
>> PatientIdentifierType.find_by_name("National id")
=> #<PatientIdentifierType patient_identifier_type_id: 3, name: "National id", description: "National ID number developed by Baobab", format: "", check_digit: false, creator: 1, date_created: "2007-11-29 22:12:34", required: false, format_description: "P-175-0000004-5", validator: nil, retired: false, retired_by: nil, date_retired: nil, retire_reason: nil>
>> PatientIdentifierType.find_by_name("National id"),id
SyntaxError: compile error
(irb):2: syntax error, unexpected ',', expecting $end
PatientIdentifierType.find_by_name("National id"),id
                                                  ^
	from (irb):2
>> PatientIdentifierType.find_by_name("National id"),id[1Pid.id
=> 3
>> ^C^C
>> 
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ [H[2J]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/console[7Pruby -vscript/console[7Pruby -vscript/serverconsole[1Pserver
4=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 12:53:00] INFO  WEBrick 1.3.1
[2017-09-13 12:53:00] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 12:53:00] INFO  WEBrick::HTTPServer#start: pid=8506 port=3000
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:53:05) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1569:in `get_national_id'
  lib/patient_service.rb:1584:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.6ms)
Rendered rescues/_request_and_response (0.7ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:53:34) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1571:in `get_national_id'
  lib/patient_service.rb:1582:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:54:34) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.2ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.6ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.4ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.4ms)
Rendered rescues/_request_and_response (0.1ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:54:59) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m

RuntimeError (P170000474733):
  lib/patient_service.rb:1570:in `get_national_id'
  lib/patient_service.rb:1583:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 12:55:35) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.1ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:02:23) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 73ms (View: 43, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:02:23) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:02:23) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:02:23) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:02:23) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
ame.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (41.2ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:15:14) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 80ms (View: 10, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:15:14) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (74.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (71.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 192ms (View: 4, DB: 162) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:15:15) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 14ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:15:22) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.3ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.8ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:17:08) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 88ms (View: 9, DB: 4) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:17:08) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (72.8ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (75.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 200ms (View: 5, DB: 164) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:17:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:17:16) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fa9e5cc1bb8 @person_id=26, @name="Lazaro Yonge", @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @national_id_with_dashes="P1700-0047-4733", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.4ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:18:32) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:19:26) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:19:31) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.8ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:22:53) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 65ms (View: 35, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:22:53) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (73.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (69.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 233ms (View: 3, DB: 159) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:22:54) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 43ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:23:01) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m

ArgumentError (wrong number of arguments (0 for 1)):
  lib/patient_service.rb:1572:in `get_national_id'
  lib/patient_service.rb:1583:in `get_national_id_with_dashes'
  lib/patient_service.rb:948:in `get_patient'
  app/controllers/people_controller.rb:148:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (40.7ms)
Rendered rescues/_request_and_response (0.3ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:23:40) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:97:in `search_by_identifier'
  lib/dde3_service.rb:186:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (41.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 13:24:21] INFO  going to shutdown ...
[2017-09-13 13:24:21] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 13:24:34] INFO  WEBrick 1.3.1
[2017-09-13 13:24:34] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 13:24:34] INFO  WEBrick::HTTPServer#start: pid=9263 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:24:51) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 81ms (View: 12, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:24:51) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (74.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 228ms (View: 38, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:24:51) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:25:00) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.9ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:52:11) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 70ms (View: 39, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:52:11) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:52:11) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:52:11) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
 in 51ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:52:23) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (44.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:52:50) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 87ms (View: 11, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:52:51) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (73.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 184ms (View: 3, DB: 156) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:52:51) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 47ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 13:53:25) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 81ms (View: 11, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 13:53:26) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (74.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 190ms (View: 4, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 13:53:26) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 13:53:35) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fcfdc3ecfe8 @person_id=26, @name="Lazaro Yonge", @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @national_id_with_dashes="P1700-0047-4733", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.4ms)
Rendered rescues/_request_and_response (0.3ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:03:36) [GET]
  Parameters: {"action"=>"search", "cat"=>"mother", "controller"=>"people", "gender"=>"F"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/search

ActionView::TemplateError (You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each) on line #14 of app/views/people/search.rhtml:
11: 
12: <%
13: pos = 1
14: @patients.each do |person|
15:   next if person.blank? -%>
16: 
17:     people.push({});

    app/views/people/search.rhtml:14:in `_run_rhtml_app47views47people47search46rhtml'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:03:42) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 73ms (View: 41, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:03:42) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 237ms (View: 6, DB: 155) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:03:42) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 51ms (View: 38, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:03:49) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fcfdc5597f0 @person_id=26, @name="Lazaro Yonge", @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @national_id_with_dashes="P1700-0047-4733", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (44.4ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:05:37) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 98ms (View: 13, DB: 4) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:05:38) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (73.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 193ms (View: 5, DB: 161) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:05:38) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 52ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:05:47) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (40.8ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:06:36) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 83ms (View: 10, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:06:36) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (74.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 188ms (View: 4, DB: 158) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:06:36) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 14ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:06:45) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.2ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:07:20) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.4ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:07:23) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.2ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:07:28) [GET]
  Parameters: {"action"=>"search", "cat"=>"mother", "controller"=>"people", "gender"=>"F"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/search

ActionView::TemplateError (You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each) on line #14 of app/views/people/search.rhtml:
11: 
12: <%
13: pos = 1
14: @patients.each do |person|
15:   next if person.blank? -%>
16: 
17:     people.push({});

    app/views/people/search.rhtml:14:in `_run_rhtml_app47views47people47search46rhtml'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:07:36) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (42.3ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:10:26) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 81ms (View: 11, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:10:27) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (73.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.8ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 191ms (View: 4, DB: 158) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:10:27) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 50ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:10:37) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (43.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:12:50) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (10.7ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 88ms (View: 11, DB: 14) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:12:50) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (23.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (87.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (75.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 219ms (View: 4, DB: 189) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:12:51) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 14ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:12:57) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:13:32) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 92ms (View: 10, DB: 4) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:13:33) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (76.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (69.3ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 222ms (View: 33, DB: 162) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:13:33) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:13:40) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `identifier' for #<PatientBean:0x7fcfdc5eb9e8>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.5ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:14:09) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fcfdc65db38 @person_id=26, @name="Lazaro Yonge", @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @national_id_with_dashes="P1700-0047-4733", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:17:33) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 67ms (View: 35, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:17:34) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (72.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 226ms (View: 4, DB: 157) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:17:34) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:17:43) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P1700004747", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P1700004747') [0m
Rendering template within layouts/application
Rendering people/search

ActionView::TemplateError (You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each) on line #14 of app/views/people/search.rhtml:
11: 
12: <%
13: pos = 1
14: @patients.each do |person|
15:   next if person.blank? -%>
16: 
17:     people.push({});

    app/views/people/search.rhtml:14:in `_run_rhtml_app47views47people47search46rhtml'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (42.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:18:02) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (6.5ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (1.0ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (2.9ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.5ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:32:32) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fcfdc9df9a0 @person_id=26, @name="Lazaro Yonge", @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @national_id_with_dashes="P1700-0047-4733", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26>):
  app/controllers/people_controller.rb:149:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.3ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:34:22) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 86ms (View: 9, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:34:22) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (74.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 228ms (View: 38, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:34:23) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:34:30) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `national_id_with_hashes' for #<PatientBean:0x7fcfdc5e3950>):
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:35:36) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `national_id_with_hashes' for #<PatientBean:0x7fcfdc665e50>):
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.4ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:35:38) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `national_id_with_hashes' for #<PatientBean:0x7fcfdc62cc18>):
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:36:02) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 68ms (View: 37, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:36:02) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.3ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (70.7ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (67.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 226ms (View: 4, DB: 154) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:36:02) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 42ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:36:09) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (41.3ms)
Rendered rescues/_request_and_response (0.3ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:38:50) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 88ms (View: 10, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:38:50) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.9ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (72.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 185ms (View: 3, DB: 157) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:38:50) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 42ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:38:58) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:122:in `search_by_identifier'
  lib/dde3_service.rb:211:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (39.2ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:41:51] INFO  going to shutdown ...
[2017-09-13 14:41:51] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:41:59] INFO  WEBrick 1.3.1
[2017-09-13 14:41:59] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:41:59] INFO  WEBrick::HTTPServer#start: pid=10916 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:42:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 79ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:42:10) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (66.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (65.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 174ms (View: 5, DB: 147) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:42:10) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:42:22) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.5ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:43:04] INFO  going to shutdown ...
[2017-09-13 14:43:04] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:43:09] INFO  WEBrick 1.3.1
[2017-09-13 14:43:09] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:43:09] INFO  WEBrick::HTTPServer#start: pid=11056 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:43:13) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 79ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:43:14) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (73.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 220ms (View: 35, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:43:14) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:43:18) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 70ms (View: 37, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:43:19) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 182ms (View: 4, DB: 152) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:43:19) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 1, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:43:25) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (2.7ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7feaf3fa59e8 @national_id_with_dashes="P1700-0047-4733", @name="Lazaro Yonge", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26, @person_id=26, @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.1ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:44:59) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7feaf3ffa010 @national_id_with_dashes="P1700-0047-4733", @name="Lazaro Yonge", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26, @person_id=26, @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.2ms)
Rendered rescues/_request_and_response (0.4ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:45:05) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 77ms (View: 43, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:45:06) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (72.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 231ms (View: 4, DB: 157) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:45:06) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:45:13) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7feaf3fa3328 @national_id_with_dashes="P1700-0047-4733", @name="Lazaro Yonge", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26, @person_id=26, @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.3ms)
Rendered rescues/_request_and_response (32.5ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:46:03) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 78ms (View: 11, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:46:04) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.9ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (72.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (71.3ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 238ms (View: 5, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:46:04) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 55ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:46:11) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000474733", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7feaf3ecdb60 @national_id_with_dashes="P1700-0047-4733", @name="Lazaro Yonge", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26, @person_id=26, @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (44.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:47:19] INFO  going to shutdown ...
[2017-09-13 14:47:19] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:47:22] INFO  WEBrick 1.3.1
[2017-09-13 14:47:22] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:47:22] INFO  WEBrick::HTTPServer#start: pid=11257 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:47:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 85ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:47:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (66.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (63.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 176ms (View: 6, DB: 145) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:47:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 16ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:47:36) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.0ms)
Rendered rescues/_request_and_response (0.8ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:48:38) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.3ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:48:44) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:48:48) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 74ms (View: 41, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:48:49) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (74.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (72.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 256ms (View: 4, DB: 162) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:48:49) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 16ms (View: 1, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:48:52) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 72ms (View: 11, DB: 2) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:48:53) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (12.3ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.7ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (66.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 222ms (View: 4, DB: 151) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:48:53) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:49:02) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.1ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:50:43) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 72ms (View: 41, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:50:43) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (9.9ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (71.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 234ms (View: 4, DB: 166) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:50:43) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 51ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:50:51) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `strip' for nil:NilClass):
  lib/dde3_service.rb:124:in `search_by_identifier'
  lib/dde3_service.rb:213:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (48.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:50:57] INFO  going to shutdown ...
[2017-09-13 14:50:58] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:51:05] INFO  WEBrick 1.3.1
[2017-09-13 14:51:05] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:51:05] INFO  WEBrick::HTTPServer#start: pid=11472 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:51:17) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 83ms (View: 13, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:51:17) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 183ms (View: 6, DB: 153) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:51:17) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 16ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:51:23) [GET]
  Parameters: {"controller"=>"people", "identifier"=>"P170000474733", "action"=>"search"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7fdb2b3768c0 @national_id_with_dashes="P1700-0047-4733", @name="Lazaro Yonge", @cell_phone_number=nil, @eid_number=nil, @sex="Male", @guardian=nil, @birth_date="10/Oct/1975", @age_in_months=503, @patient_id=26, @person_id=26, @mothers_surname="", @age=41, @last_name="Yonge", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Lazaro", @national_id=nil, @filing_number=nil, @landmark=nil, @address="", @office_phone_number=nil, @pre_art_number=nil, @traditional_authority="", @birthdate_estimated=false, @arv_number=nil>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.0ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:55:53] INFO  going to shutdown ...
[2017-09-13 14:55:53] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:55:56] INFO  WEBrick 1.3.1
[2017-09-13 14:55:56] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:55:57] INFO  WEBrick::HTTPServer#start: pid=11587 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:56:05) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 85ms (View: 13, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:56:05) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 186ms (View: 6, DB: 154) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:56:05) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:56:13) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.1ms)
Rendered rescues/_request_and_response (0.5ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:57:13) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000556752"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556752' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 27) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 27) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.3ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 27 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.3ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;35;1mRelationship Load (0.2ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 27) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.3ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:58:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000556752"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556752' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 27) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 27) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 27 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 27) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:58:30) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000556752"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556752' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 27) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;35;1mPerson Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 27) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 27 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 27) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.5ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:58:35) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.1ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 71ms (View: 37, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:58:35) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 227ms (View: 4, DB: 153) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:58:35) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 12ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:58:50) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000556752"}
  [4;35;1mUser Columns (60.0ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556752' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 27) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 27) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 27 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 27) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (nil):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.8ms)
Rendered rescues/_request_and_response (31.6ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:58:57] INFO  going to shutdown ...
[2017-09-13 14:58:58] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:59:00] INFO  WEBrick 1.3.1
[2017-09-13 14:59:00] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:59:00] INFO  WEBrick::HTTPServer#start: pid=11768 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 14:59:13) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 84ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 14:59:13) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (66.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (65.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 175ms (View: 5, DB: 148) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 14:59:14) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 14ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 14:59:24) [GET]
  Parameters: {"action"=>"search", "controller"=>"people", "identifier"=>"P170000556752"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.2ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000556752') [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 27) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 27) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 27 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 27 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 27 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 27 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 27) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 27) ORDER BY date_created DESC LIMIT 1[0m

NoMethodError (undefined method `national_id_with_hashes' for #<PatientBean:0x7f7b35d00068>):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.6ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 14:59:51] INFO  going to shutdown ...
[2017-09-13 14:59:51] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 14:59:55] INFO  WEBrick 1.3.1
[2017-09-13 14:59:55] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 14:59:55] INFO  WEBrick::HTTPServer#start: pid=11828 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:00:04) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`user_id` = 8 AND `user_property`.`property` = 'password_expiry_date') LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 80ms (View: 13, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:00:04) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 179ms (View: 5, DB: 150) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:00:04) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:00:12) [GET]
  Parameters: {"identifier"=>"P170000474733", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3 AND `patient_identifier`.`identifier` = 'P170000474733') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError ("P1700-0047-4733"):
  lib/dde3_service.rb:212:in `push_to_dde3'
  app/controllers/people_controller.rb:151:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.8ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-13 15:06:35] INFO  going to shutdown ...
[2017-09-13 15:06:35] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 15:06:38] INFO  WEBrick 1.3.1
[2017-09-13 15:06:38] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 15:06:38] INFO  WEBrick::HTTPServer#start: pid=11986 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:06:51) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 79ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:06:51) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (14.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (65.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 180ms (View: 5, DB: 151) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:06:51) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:06:59) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 26) [0m
Rendering template within layouts/application
Rendering people/search

ActionView::TemplateError (You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each) on line #14 of app/views/people/search.rhtml:
11: 
12: <%
13: pos = 1
14: @patients.each do |person|
15:   next if person.blank? -%>
16: 
17:     people.push({});

    app/views/people/search.rhtml:14:in `_run_rhtml_app47views47people47search46rhtml'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
    /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (16.8ms)
Rendered rescues/_request_and_response (35.1ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing ApplicationController#search (for 127.0.0.1 at 2017-09-13 15:15:07) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}

SyntaxError (/var/www/Maternity/app/controllers/people_controller.rb:826: syntax error, unexpected kEND, expecting $end):
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:15:27) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 26) [0m

NameError (undefined local variable or method `local_results' for #<PeopleController:0x7f832b163400>):
  app/controllers/people_controller.rb:170:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.9ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:16:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 85ms (View: 12, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:16:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (12.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (67.3ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 233ms (View: 4, DB: 150) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:16:10) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 49ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:16:17) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000474733"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000474733' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 26) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mPerson Columns (2.9ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 26) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 26 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 26 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 26 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 26 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 26) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 26) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 26) [0m
Redirected to http://localhost:3000/clinic/no_males
Completed in 117ms (DB: 6) | 302 Found [http://localhost/people/search?identifier=P170000474733]
^C[2017-09-13 15:20:43] INFO  going to shutdown ...
[2017-09-13 15:20:43] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-13 15:20:46] INFO  WEBrick 1.3.1
[2017-09-13 15:20:46] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-13 15:20:46] INFO  WEBrick::HTTPServer#start: pid=12327 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:20:56) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 79ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:20:56) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (68.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 184ms (View: 5, DB: 152) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:20:56) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:21:20) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.2ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.2ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.2ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.3ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.2ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.2ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.2ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m

RuntimeError (#<PatientBean:0x7f2d0d7d1c70 @traditional_authority="", @birthdate_estimated=false, @arv_number=nil, @name="Z Kaduya", @national_id_with_dashes="P1700-0055-6770", @cell_phone_number=nil, @eid_number=nil, @sex="Female", @guardian=nil, @birth_date="01/Jun/1984", @age_in_months=399, @patient_id=29, @person_id=29, @mothers_surname="", @age=33, @last_name="Kaduya", @occupation=nil, @archived_filing_number=nil, @home_district=nil, @home_phone_number=nil, @dead=false, @current_residence="", @first_name="Z", @national_id=nil, @address="", @filing_number=nil, @landmark=nil, @office_phone_number=nil, @pre_art_number=nil>):
  app/controllers/people_controller.rb:150:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.2ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:22:51) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 98ms (View: 9, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:22:52) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (66.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 180ms (View: 3, DB: 150) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:22:52) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:23:06) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;36;1mUser Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.1ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.2ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m

NameError (uninitialized constant DDE3Service::Patient):
  app/controllers/people_controller.rb:184:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (12.8ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:42:40) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 72ms (View: 38, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:42:40) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (12.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (66.8ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (65.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 227ms (View: 4, DB: 147) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:42:40) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.2ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 18ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:42:57) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;35;1mPatientIdentifierType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;36;1mPatientIdentifierType Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
Redirected to http://localhost:3000/encounters/new?patient_id=29
Completed in 116ms (DB: 4) | 302 Found [http://localhost/people/search?identifier=P170000556770]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing ApplicationController#new (for 127.0.0.1 at 2017-09-13 15:42:57) [GET]
  Parameters: {"action"=>"new", "patient_id"=>"29", "controller"=>"encounters"}

RegexpError (unmatched (: /(?:\d{2}|){2,}/):
  barby (0.6.5) lib/barby/barcode/code_128.rb:409
  app/controllers/encounters_controller.rb:2
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:45:22) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 74ms (View: 9, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:45:22) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (75.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 185ms (View: 3, DB: 159) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:45:22) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 17ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:45:45) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m

RuntimeError (#<Patient patient_id: 29, tribe: nil, creator: 24, date_created: "2010-12-23 11:48:52", changed_by: 24, date_changed: "2010-12-23 11:48:52", voided: false, voided_by: nil, date_voided: nil, void_reason: nil>):
  app/controllers/people_controller.rb:185:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:47:57) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 72ms (View: 40, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:47:57) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (12.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (70.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 239ms (View: 6, DB: 154) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:47:57) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 12ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:48:08) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;36;1mUser Columns (11.8ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m

RuntimeError ("P170000556770"):
  app/controllers/people_controller.rb:187:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (44.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:48:45) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.2ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.1ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 93ms (View: 11, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:48:46) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.8ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (73.9ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (68.7ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 193ms (View: 4, DB: 159) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:48:46) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 49ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:48:55) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;36;1mUser Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.8ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;35;1mPatientIdentifierType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m

RuntimeError ("P170000556770"):
  app/controllers/people_controller.rb:189:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (13.3ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:54:32) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.2ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
Redirected to http://localhost:3000/encounters/new?patient_id=29
Completed in 142ms (DB: 4) | 302 Found [http://localhost/people/search?identifier=P170000556770]
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:31: warning: already initialized constant FNC1
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:32: warning: already initialized constant FNC2
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:33: warning: already initialized constant FNC3
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:34: warning: already initialized constant FNC4
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:35: warning: already initialized constant CODEA
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:36: warning: already initialized constant CODEB
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:37: warning: already initialized constant CODEC
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:38: warning: already initialized constant SHIFT
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:39: warning: already initialized constant STARTA
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:40: warning: already initialized constant STARTB
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:41: warning: already initialized constant STARTC
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:43: warning: already initialized constant STOP
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:44: warning: already initialized constant TERMINATE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:82: warning: already initialized constant ENCODINGS
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:166: warning: already initialized constant VALUES
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:169: warning: already initialized constant CONTROL_CHARACTERS
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:404: warning: already initialized constant CTRL_RE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:405: warning: already initialized constant LOWR_RE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:406: warning: already initialized constant DGTS_RE
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing ApplicationController#new (for 127.0.0.1 at 2017-09-13 15:54:32) [GET]
  Parameters: {"action"=>"new", "patient_id"=>"29", "controller"=>"encounters"}

RegexpError (unmatched (: /(?:\d{2}|){2,}/):
  barby (0.6.5) lib/barby/barcode/code_128.rb:409
  app/controllers/encounters_controller.rb:2
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (49.2ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:54:40) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 71ms (View: 10, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:54:40) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (73.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (69.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 189ms (View: 4, DB: 159) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:54:40) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 43ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:54:52) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
Redirected to http://localhost:3000/encounters/new?patient_id=29
Completed in 138ms (DB: 4) | 302 Found [http://localhost/people/search?identifier=P170000556770]
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:31: warning: already initialized constant FNC1
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:32: warning: already initialized constant FNC2
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:33: warning: already initialized constant FNC3
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:34: warning: already initialized constant FNC4
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:35: warning: already initialized constant CODEA
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:36: warning: already initialized constant CODEB
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:37: warning: already initialized constant CODEC
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:38: warning: already initialized constant SHIFT
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:39: warning: already initialized constant STARTA
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:40: warning: already initialized constant STARTB
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:41: warning: already initialized constant STARTC
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:43: warning: already initialized constant STOP
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:44: warning: already initialized constant TERMINATE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:82: warning: already initialized constant ENCODINGS
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:166: warning: already initialized constant VALUES
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:169: warning: already initialized constant CONTROL_CHARACTERS
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:404: warning: already initialized constant CTRL_RE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:405: warning: already initialized constant LOWR_RE
/home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/barby-0.6.5/lib/barby/barcode/code_128.rb:406: warning: already initialized constant DGTS_RE
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing ApplicationController#new (for 127.0.0.1 at 2017-09-13 15:54:52) [GET]
  Parameters: {"action"=>"new", "patient_id"=>"29", "controller"=>"encounters"}

RegexpError (unmatched (: /(?:\d{2}|){2,}/):
  barby (0.6.5) lib/barby/barcode/code_128.rb:409
  app/controllers/encounters_controller.rb:2
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (11.6ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-13 15:58:59) [GET]
  Parameters: {"action"=>"index", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.0ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-13') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 69ms (View: 37, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-13 15:59:00) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (66.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 222ms (View: 4, DB: 153) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-13 15:59:00) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-13 15:59:12) [GET]
  Parameters: {"action"=>"search", "identifier"=>"P170000556770", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m

RuntimeError ("P170000556770"):
  app/controllers/people_controller.rb:188:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (44.0ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-14 08:21:37] INFO  going to shutdown ...
[2017-09-14 08:21:37] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-14 08:21:42] INFO  WEBrick 1.3.1
[2017-09-14 08:21:42] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-14 08:21:52] INFO  WEBrick::HTTPServer#start: pid=15225 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:22:49) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (366.9ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;36;1mGlobalProperty Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 453ms (View: 14, DB: 371) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:22:50) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (71.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (75.0ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 190ms (View: 5, DB: 162) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 08:22:50) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 16ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-14 08:23:29) [GET]
  Parameters: {"controller"=>"people", "action"=>"search", "identifier"=>"P170000556770"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770') [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (30.2ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 4) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.2ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 3) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'EID Number') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Pre ART Number (Old format)') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Archived filing number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 18) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.2ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Filing Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 17) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAttributeType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_attribute_type`[0m
  [4;36;1mPersonAttributeType Load (0.3ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Occupation') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (55.4ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 13 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.2ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Cell phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (26.9ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 12 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.2ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Office phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (10.4ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 15 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.2ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Home phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (16.8ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 14 AND person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.2ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Race') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (54.7ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 1 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.2ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Citizenship') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (17.7ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 3 AND person_id = 29) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/search
  [4;36;1mUserProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.1ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 417ms (View: 13, DB: 220) | 200 OK [http://localhost/people/search?identifier=P170000556770]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#select (for 127.0.0.1 at 2017-09-14 08:24:15) [POST]
  Parameters: {"cat"=>"", "given_name"=>"", "family_name"=>"", "address2"=>"", "gender"=>"", "relation"=>"", "controller"=>"people", "action"=>"select", "remote"=>"true", "patient_id"=>"", "person"=>{"id"=>"0"}, "family_name2"=>"", "identifier"=>"", "ident"=>"P170000556770"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = '') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m
Redirected to http://localhost:3000/people/new?address2=&cat=&family_name2=&family_name=&gender=&given_name=&identifier=P170000556770&patient_id=&relation=
Completed in 3087ms (DB: 2) | 302 Found [http://localhost/people/select?patient_id=&cat=&ident=P170000556770]
/var/www/Maternity/app/views/people/new.rhtml:275: warning: Object#id will be deprecated; use Object#object_id
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#new (for 127.0.0.1 at 2017-09-14 08:24:18) [GET]
  Parameters: {"cat"=>"", "address2"=>"", "family_name"=>"", "given_name"=>"", "gender"=>"", "relation"=>"", "controller"=>"people", "action"=>"new", "patient_id"=>"", "family_name2"=>"", "identifier"=>"P170000556770"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.cellPhone') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.homePhone') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.officePhone') LIMIT 1[0m
Rendering template within layouts/application
Rendering people/new
  [4;36;1mUserProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 70ms (View: 54, DB: 2) | 200 OK [http://localhost/people/new?address2=&cat=&family_name2=&family_name=&gender=&given_name=&identifier=P170000556770&patient_id=&relation=]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PersonNamesController#given_names (for 127.0.0.1 at 2017-09-14 08:24:19) [GET]
  Parameters: {"controller"=>"person_names", "action"=>"given_names", "search_string"=>""}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.6ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPersonNameCode Load (0.1ms)[0m   [0;1mSELECT DISTINCT given_name AS given_name, person_name.person_name_id AS id
 FROM person_name_code INNER JOIN person_name ON person_name_code.person_name_id = person_name.person_name_id INNER JOIN person ON person.person_id = person_name.person_id WHERE person.voided = 0 AND person_name.voided = 0 AND given_name_code LIKE '%' GROUP BY given_name ORDER BY CASE INSTR(given_name,'') WHEN 0 THEN 9999 ELSE INSTR(given_name,'') END ASC, CASE INSTR(given_name_code,NULL) WHEN 0 THEN 9999 ELSE INSTR(given_name_code,NULL) END ASC, ABS(LENGTH(given_name_code) - LENGTH(NULL)) ASC,
 COUNT(given_name) DESC, given_name ASC LIMIT 10[0m
  [4;35;1mPersonNameCode Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `person_name_code`[0m
Completed in 20ms (View: 0, DB: 2) | 200 OK [http://localhost/person_names/given_names?search_string=]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#select (for 127.0.0.1 at 2017-09-14 08:25:29) [POST]
  Parameters: {"cat"=>"", "given_name"=>"", "family_name"=>"", "address2"=>"", "gender"=>"", "relation"=>"", "controller"=>"people", "action"=>"select", "remote"=>"true", "patient_id"=>"", "person"=>{"id"=>"0"}, "family_name2"=>"", "identifier"=>"", "ident"=>"P170000556770"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = '') [0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m
Redirected to http://localhost:3000/people/new?address2=&cat=&family_name2=&family_name=&gender=&given_name=&identifier=P170000556770&patient_id=&relation=
Completed in 3077ms (DB: 2) | 302 Found [http://localhost/people/select?patient_id=&cat=&ident=P170000556770]
/var/www/Maternity/app/views/people/new.rhtml:275: warning: Object#id will be deprecated; use Object#object_id
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#new (for 127.0.0.1 at 2017-09-14 08:25:32) [GET]
  Parameters: {"cat"=>"", "address2"=>"", "family_name"=>"", "given_name"=>"", "gender"=>"", "relation"=>"", "controller"=>"people", "action"=>"new", "patient_id"=>"", "family_name2"=>"", "identifier"=>"P170000556770"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.cellPhone') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.homePhone') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'use_patient_attribute.officePhone') LIMIT 1[0m
Rendering template within layouts/application
Rendering people/new
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 30ms (View: 14, DB: 2) | 200 OK [http://localhost/people/new?address2=&cat=&family_name2=&family_name=&gender=&given_name=&identifier=P170000556770&patient_id=&relation=]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PersonNamesController#given_names (for 127.0.0.1 at 2017-09-14 08:25:32) [GET]
  Parameters: {"controller"=>"person_names", "action"=>"given_names", "search_string"=>""}
  [4;36;1mUser Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPersonNameCode Load (0.1ms)[0m   [0;1mSELECT DISTINCT given_name AS given_name, person_name.person_name_id AS id
 FROM person_name_code INNER JOIN person_name ON person_name_code.person_name_id = person_name.person_name_id INNER JOIN person ON person.person_id = person_name.person_id WHERE person.voided = 0 AND person_name.voided = 0 AND given_name_code LIKE '%' GROUP BY given_name ORDER BY CASE INSTR(given_name,'') WHEN 0 THEN 9999 ELSE INSTR(given_name,'') END ASC, CASE INSTR(given_name_code,NULL) WHEN 0 THEN 9999 ELSE INSTR(given_name_code,NULL) END ASC, ABS(LENGTH(given_name_code) - LENGTH(NULL)) ASC,
 COUNT(given_name) DESC, given_name ASC LIMIT 10[0m
  [4;35;1mPersonNameCode Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name_code`[0m
Completed in 16ms (View: 0, DB: 2) | 200 OK [http://localhost/person_names/given_names?search_string=]
^C[2017-09-14 08:51:38] INFO  going to shutdown ...
[2017-09-14 08:51:38] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ script/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-14 08:51:42] INFO  WEBrick 1.3.1
[2017-09-14 08:51:42] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-14 08:51:47] INFO  WEBrick::HTTPServer#start: pid=15807 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:51:53) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 82ms (View: 12, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:51:54) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (13.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.8ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.3ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 191ms (View: 6, DB: 157) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 08:51:54) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.7ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 16ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-14 08:52:12) [GET]
  Parameters: {"identifier"=>"P170000556770", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.5ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770') [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 4) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 3) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'EID Number') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Pre ART Number (Old format)') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Archived filing number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 18) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifierType Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Filing Number') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 17) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAttributeType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_attribute_type`[0m
  [4;36;1mPersonAttributeType Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Occupation') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 13 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Cell phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.1ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 12 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Office phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 15 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Home phone number') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 14 AND person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.1ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Race') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 1 AND person_id = 29) LIMIT 1[0m
  [4;36;1mPersonAttributeType Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Citizenship') LIMIT 1[0m
  [4;35;1mPersonAttribute Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 3 AND person_id = 29) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/search
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 182ms (View: 13, DB: 6) | 200 OK [http://localhost/people/search?identifier=P170000556770]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#select (for 127.0.0.1 at 2017-09-14 08:52:38) [POST]
  Parameters: {"identifier"=>"P170000556770", "gender"=>"", "given_name"=>"", "relation"=>"", "ident"=>"P170000556770", "family_name"=>"", "cat"=>"", "controller"=>"people", "person"=>{"id"=>"P170000556770"}, "address2"=>"", "action"=>"select", "remote"=>"true", "patient_id"=>"", "family_name2"=>""}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 0) [0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770') [0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPatient Load (0.1ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifierType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;36;1mPatientIdentifierType Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m

Errno::EHOSTUNREACH (No route to host - connect(2)):
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `initialize'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `open'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `connect'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/timeout.rb:53:in `timeout'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/timeout.rb:101:in `timeout'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `connect'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:553:in `do_start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:542:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:172:in `transmit'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:64:in `execute'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:33:in `execute'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient.rb:68:in `get'
  lib/dde_service.rb:187:in `replace_old_national_id'
  lib/dde_service.rb:170:in `check_old_national_id'
  app/controllers/people_controller.rb:309:in `select'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (14.1ms)
Rendered rescues/_request_and_response (0.6ms)
Rendering rescues/layout (internal_server_error)
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:55:01) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;36;1mGlobalProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 73ms (View: 39, DB: 3) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:55:02) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1m  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:55:02) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
User Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.6ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (72.9ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
Rendering people/admin
Completed in 54ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:55:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mUserProperty Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `user_property`[0m
  [4;35;1mUserProperty Load (0.0ms)[0m   [0mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mUserRole Load (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;35;1mUserRole Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `user_role`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mPerson Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;35;1mPersonName Load (0.1ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;36;1mSQL (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 78ms (View: 11, DB: 4) | 200 OK [http://localhost/]
  [4;36;1mSQL (0.0ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:55:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.5ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (70.7ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 224ms (View: 5, DB: 156) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 08:55:09) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 13ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-14 08:55:21) [GET]
  Parameters: {"identifier"=>"P170000556770", "controller"=>"people", "action"=>"search"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.8ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mPatientIdentifier Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient_identifier`[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;35;1mRelationshipType Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPatient Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `patient`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAddress Load (0.1ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mPersonAddress Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `person_address`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mPersonName Load (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mRelationship Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;36;1mPatientIdentifierType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m

RuntimeError ("P170000556770"):
  app/controllers/people_controller.rb:184:in `search'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (42.7ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:58:16) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 85ms (View: 11, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:58:16) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.9ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (73.4ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (70.5ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 193ms (View: 4, DB: 160) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 08:58:17) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.7ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 53ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#index (for 127.0.0.1 at 2017-09-14 08:58:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"index"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'password_expiry_date' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mUserRole Load (0.0ms)[0m   [0mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
  [4;36;1mUserRole Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `user_role`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 789) [0m
  [4;36;1mLocation Load (0.0ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 8) [0m
  [4;36;1mPersonName Load (0.1ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 8 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `user_role` WHERE (user_role.user_id = 8) [0m
Rendering template within layouts/menu
Rendering people/index
  [4;35;1mSQL (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM encounter GROUP BY encounter_type[0m
  [4;36;1mEncounter Load (0.0ms)[0m   [0;1mSELECT * FROM `encounter` WHERE (DATE(encounter_datetime) = '2017-09-14') [0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 78ms (View: 10, DB: 3) | 200 OK [http://localhost/]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 08:58:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"overview"}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.1ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mGlobalProperty Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `global_property`[0m
  [4;35;1mGlobalProperty Load (0.1ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;36;1mEncounterType Load (0.1ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounterType Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `encounter_type`[0m
  [4;36;1mEncounter Load (13.2ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (70.6ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (69.0ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounter Load (0.1ms)[0m   [0;1mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;35;1mEncounter Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 189ms (View: 4, DB: 156) | 200 OK [http://localhost/people/overview]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 08:58:28) [GET]
  Parameters: {"controller"=>"people", "action"=>"admin"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 0, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-14 08:58:38) [GET]
  Parameters: {"identifier"=>"P170000556770", "controller"=>"people", "action"=>"search"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.0ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770' AND `patient_identifier`.`identifier_type` = 3) [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.0ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPatient Load (0.0ms)[0m   [0;1mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAddress Load (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mPersonAddress Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_address`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPersonName Load (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mPersonName Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person_name`[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mRelationship Load (0.1ms)[0m   [0mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (`person`.`person_id` = 29) [0m
  [4;35;1mPatientIdentifierType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770') [0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'ARV Number') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 4) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 3) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `person_address` WHERE (person_address.person_id = 29 AND (person_address.voided = 0)) ORDER BY person_address.preferred DESC LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person_name` WHERE (person_name.person_id = 29 AND (person_name.voided = 0)) ORDER BY person_name.preferred DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'EID Number') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.1ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Pre ART Number (Old format)') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = NULL) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Archived filing number') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 18) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPatientIdentifierType Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'Filing Number') LIMIT 1[0m
  [4;35;1mPatientIdentifier Load (0.0ms)[0m   [0mSELECT identifier FROM `patient_identifier` WHERE (patient_id = 29 and identifier_type = 17) ORDER BY date_created DESC LIMIT 1[0m
  [4;36;1mPersonAttributeType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_attribute_type`[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Occupation') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 13 AND person_id = 29) LIMIT 1[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Cell phone number') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 12 AND person_id = 29) LIMIT 1[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Office phone number') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 15 AND person_id = 29) LIMIT 1[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Home phone number') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 14 AND person_id = 29) LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `relationship` WHERE (person_a = 29) ORDER BY date_created DESC LIMIT 1[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Race') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 1 AND person_id = 29) LIMIT 1[0m
  [4;35;1mPersonAttributeType Load (0.0ms)[0m   [0mSELECT * FROM `person_attribute_type` WHERE (`person_attribute_type`.`name` = 'Citizenship') LIMIT 1[0m
  [4;36;1mPersonAttribute Load (0.0ms)[0m   [0;1mSELECT * FROM `person_attribute` WHERE (voided = 0 AND person_attribute_type_id = 3 AND person_id = 29) LIMIT 1[0m
Rendering template within layouts/application
Rendering people/search
  [4;35;1mUserProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `user_property`[0m
  [4;36;1mUserProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `user_property` WHERE (`user_property`.`property` = 'keyboard' AND `user_property`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'show_intro_text') LIMIT 1[0m
Completed in 180ms (View: 5, DB: 6) | 200 OK [http://localhost/people/search?identifier=P170000556770]
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#select (for 127.0.0.1 at 2017-09-14 08:58:45) [POST]
  Parameters: {"identifier"=>"P170000556770", "gender"=>"", "given_name"=>"", "relation"=>"", "ident"=>"P170000556770", "family_name"=>"", "cat"=>"", "controller"=>"people", "person"=>{"id"=>"P170000556770"}, "address2"=>"", "action"=>"select", "remote"=>"true", "patient_id"=>"", "family_name2"=>""}
  [4;36;1mUser Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;36;1mPerson Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `person`[0m
  [4;35;1mPerson Load (0.1ms)[0m   [0mSELECT * FROM `person` WHERE (`person`.`person_id` = 0) [0m
  [4;36;1mPatientIdentifier Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier`[0m
  [4;35;1mPatientIdentifier Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier` = 'P170000556770') [0m
  [4;36;1mRelationshipType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `relationship_type`[0m
  [4;35;1mRelationshipType Load (0.1ms)[0m   [0mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPatient Load (0.1ms)[0m   [0mSELECT * FROM `patient` WHERE (`patient`.`patient_id` = 29) [0m
  [4;36;1mPerson Load (0.1ms)[0m   [0;1mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;35;1mPatient Load (0.0ms)[0m   [0mSELECT * FROM `patient` WHERE (patient.patient_id = 29) LIMIT 1[0m
  [4;36;1mPatientIdentifierType Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `patient_identifier_type`[0m
  [4;35;1mPatientIdentifierType Load (0.1ms)[0m   [0mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;36;1mPatientIdentifier Load (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;35;1mGlobalProperty Load (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;36;1mGlobalProperty Load (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `person` WHERE (person.person_id = 29) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `patient_identifier_type` WHERE (`patient_identifier_type`.`name` = 'National id') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `patient_identifier` WHERE (`patient_identifier`.`identifier_type` = 3) AND (patient_identifier.patient_id = 29 AND (patient_identifier.voided = 0)) LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_ip') LIMIT 1[0m
  [4;35;1mCACHE (0.0ms)[0m   [0mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_username') LIMIT 1[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'dde_server_password') LIMIT 1[0m

Errno::EHOSTUNREACH (No route to host - connect(2)):
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `initialize'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `open'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `connect'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/timeout.rb:53:in `timeout'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/timeout.rb:101:in `timeout'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:560:in `connect'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:553:in `do_start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/net/http.rb:542:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:172:in `transmit'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:64:in `execute'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient/request.rb:33:in `execute'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/gems/1.8/gems/rest-client-1.6.7/lib/restclient.rb:68:in `get'
  lib/dde_service.rb:187:in `replace_old_national_id'
  lib/dde_service.rb:170:in `check_old_national_id'
  app/controllers/people_controller.rb:308:in `select'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:162:in `start_thread'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:95:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `each'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:92:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:23:in `start'
  /home/taona/.rbenv/versions/1.8.7-p374/lib/ruby/1.8/webrick/server.rb:82:in `start'

Rendered rescues/_trace (15.1ms)
Rendered rescues/_request_and_response (0.2ms)
Rendering rescues/layout (internal_server_error)
^C[2017-09-14 09:17:07] INFO  going to shutdown ...
[2017-09-14 09:17:07] INFO  WEBrick::HTTPServer#start done.
Exiting
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ cd [K[K[Kgit branch
* [32mdde_integration[m
  v1[m
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git status
On branch dde_integration
Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	[31mmodified:   Gemfile[m
	[31mmodified:   Rakefile[m
	[31mmodified:   app/controllers/people_controller.rb[m
	[31mmodified:   app/controllers/user_controller.rb[m
	[31mmodified:   app/helpers/application_helper.rb[m
	[31mmodified:   app/views/people/admin.rhtml[m
	[31mmodified:   app/views/user/user_menu.rhtml[m
	[31mmodified:   lib/patient_service.rb[m
	[31mdeleted:    lib/tasks/rspec.rake[m
	[31mdeleted:    vendor/cache/barby-0.5.0.gem[m
	[31mdeleted:    vendor/cache/daemon_controller-1.2.0.gem[m
	[31mdeleted:    vendor/cache/json-1.8.1.gem[m
	[31mdeleted:    vendor/cache/mime-types-1.25.1.gem[m
	[31mdeleted:    vendor/cache/nokogiri-1.5.6.gem[m
	[31mdeleted:    vendor/cache/passenger-4.0.48.gem[m
	[31mdeleted:    vendor/cache/rake-10.3.2.gem[m
	[31mdeleted:    vendor/cache/rcov-1.0.0.gem[m
	[31mdeleted:    vendor/cache/rest-client-1.6.7.gem[m
	[31mdeleted:    vendor/cache/rmagick-2.13.2.gem[m
	[31mdeleted:    vendor/cache/rqrcode-0.4.2.gem[m

Untracked files:
  (use "git add <file>..." to include in what will be committed)

	[31m.ruby-version[m
	[31mconfig/initializers/[m
	[31mconsole[m
	[31mlib/dde3_service.rb[m
	[31ms/[m
	[31mserver[m
	[31mstart/[m
	[31mvendor/cache/barby-0.6.5.gem[m
	[31mvendor/cache/chunky_png-1.3.8.gem[m
	[31mvendor/cache/docile-1.1.5.gem[m
	[31mvendor/cache/domain_name-0.5.20170404.gem[m
	[31mvendor/cache/http-cookie-1.0.3.gem[m
	[31mvendor/cache/iconv-1.0.4.gem[m
	[31mvendor/cache/json-2.1.0.gem[m
	[31mvendor/cache/mime-types-3.1.gem[m
	[31mvendor/cache/mime-types-data-3.2016.0521.gem[m
	[31mvendor/cache/mini_portile2-2.2.0.gem[m
	[31mvendor/cache/netrc-0.11.0.gem[m
	[31mvendor/cache/nokogiri-1.8.0.gem[m
	[31mvendor/cache/passenger-5.1.8.gem[m
	[31mvendor/cache/rake-0.9.2.2.gem[m
	[31mvendor/cache/rest-client-2.0.2.gem[m
	[31mvendor/cache/rmagick-2.16.0.gem[m
	[31mvendor/cache/rqrcode-0.10.1.gem[m
	[31mvendor/cache/simplecov-0.15.0.gem[m
	[31mvendor/cache/simplecov-html-0.10.2.gem[m
	[31mvendor/cache/unf-0.1.4.gem[m
	[31mvendor/cache/unf_ext-0.0.7.4.gem[m

no changes added to commit (use "git add" and/or "git commit -a")
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git add .
warning: You ran 'git add' with neither '-A (--all)' or '--ignore-removal',
whose behaviour will change in Git 2.0 with respect to paths you removed.
Paths like 'lib/tasks/rspec.rake' that are
removed from your working tree are ignored with this version of Git.

* 'git add --ignore-removal <pathspec>', which is the current default,
  ignores paths you removed from your working tree.

* 'git add --all <pathspec>' will let you also record the removals.

Run 'git status' to check the paths you removed from your working tree.

]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git status
On branch dde_integration
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

	[32mnew file:   .ruby-version[m
	[32mmodified:   Gemfile[m
	[32mmodified:   Rakefile[m
	[32mmodified:   app/controllers/people_controller.rb[m
	[32mmodified:   app/controllers/user_controller.rb[m
	[32mmodified:   app/helpers/application_helper.rb[m
	[32mmodified:   app/views/people/admin.rhtml[m
	[32mmodified:   app/views/user/user_menu.rhtml[m
	[32mnew file:   config/initializers/dde3_user.rb[m
	[32mnew file:   console[m
	[32mnew file:   lib/dde3_service.rb[m
	[32mmodified:   lib/patient_service.rb[m
	[32mnew file:   s/README[m
	[32mnew file:   s/Rakefile[m
	[32mnew file:   s/app/controllers/application_controller.rb[m
	[32mnew file:   s/app/helpers/application_helper.rb[m
	[32mnew file:   s/config/boot.rb[m
	[32mnew file:   s/config/environment.rb[m
	[32mnew file:   s/config/environments/development.rb[m
	[32mnew file:   s/config/environments/production.rb[m
	[32mnew file:   s/config/environments/test.rb[m
	[32mnew file:   s/config/initializers/backtrace_silencers.rb[m
	[32mnew file:   s/config/initializers/inflections.rb[m
	[32mnew file:   s/config/initializers/mime_types.rb[m
	[32mnew file:   s/config/initializers/new_rails_defaults.rb[m
	[32mnew file:   s/config/initializers/session_store.rb[m
	[32mnew file:   s/config/routes.rb[m
	[32mnew file:   s/db/seeds.rb[m
	[32mnew file:   s/public/404.html[m
	[32mnew file:   s/public/422.html[m
	[32mnew file:   s/public/500.html[m
	[32mnew file:   s/public/favicon.ico[m
	[32mnew file:   s/public/images/rails.png[m
	[32mnew file:   s/public/index.html[m
	[32mnew file:   s/public/javascripts/application.js[m
	[32mnew file:   s/public/javascripts/controls.js[m
	[32mnew file:   s/public/javascripts/dragdrop.js[m
	[32mnew file:   s/public/javascripts/effects.js[m
	[32mnew file:   s/public/javascripts/prototype.js[m
	[32mnew file:   s/public/robots.txt[m
	[32mnew file:   s/script/about[m
	[32mnew file:   s/script/console[m
	[32mnew file:   s/script/dbconsole[m
	[32mnew file:   s/script/destroy[m
	[32mnew file:   s/script/generate[m
	[32mnew file:   s/script/performance/benchmarker[m
	[32mnew file:   s/script/performance/profiler[m
	[32mnew file:   s/script/plugin[m
	[32mnew file:   s/script/runner[m
	[32mnew file:   s/script/server[m
	[32mnew file:   s/test/performance/browsing_test.rb[m
	[32mnew file:   s/test/test_helper.rb[m
	[32mnew file:   server[m
	[32mnew file:   start/README[m
	[32mnew file:   start/Rakefile[m
	[32mnew file:   start/app/controllers/application_controller.rb[m
	[32mnew file:   start/app/helpers/application_helper.rb[m
	[32mnew file:   start/config/boot.rb[m
	[32mnew file:   start/config/environment.rb[m
	[32mnew file:   start/config/environments/development.rb[m
	[32mnew file:   start/config/environments/production.rb[m
	[32mnew file:   start/config/environments/test.rb[m
	[32mnew file:   start/config/initializers/backtrace_silencers.rb[m
	[32mnew file:   start/config/initializers/inflections.rb[m
	[32mnew file:   start/config/initializers/mime_types.rb[m
	[32mnew file:   start/config/initializers/new_rails_defaults.rb[m
	[32mnew file:   start/config/initializers/session_store.rb[m
	[32mnew file:   start/config/routes.rb[m
	[32mnew file:   start/db/seeds.rb[m
	[32mnew file:   start/public/404.html[m
	[32mnew file:   start/public/422.html[m
	[32mnew file:   start/public/500.html[m
	[32mnew file:   start/public/favicon.ico[m
	[32mnew file:   start/public/images/rails.png[m
	[32mnew file:   start/public/index.html[m
	[32mnew file:   start/public/javascripts/application.js[m
	[32mnew file:   start/public/javascripts/controls.js[m
	[32mnew file:   start/public/javascripts/dragdrop.js[m
	[32mnew file:   start/public/javascripts/effects.js[m
	[32mnew file:   start/public/javascripts/prototype.js[m
	[32mnew file:   start/public/robots.txt[m
	[32mnew file:   start/script/about[m
	[32mnew file:   start/script/console[m
	[32mnew file:   start/script/dbconsole[m
	[32mnew file:   start/script/destroy[m
	[32mnew file:   start/script/generate[m
	[32mnew file:   start/script/performance/benchmarker[m
	[32mnew file:   start/script/performance/profiler[m
	[32mnew file:   start/script/plugin[m
	[32mnew file:   start/script/runner[m
	[32mnew file:   start/script/server[m
	[32mnew file:   start/test/performance/browsing_test.rb[m
	[32mnew file:   start/test/test_helper.rb[m
	[32mnew file:   vendor/cache/barby-0.6.5.gem[m
	[32mnew file:   vendor/cache/chunky_png-1.3.8.gem[m
	[32mnew file:   vendor/cache/docile-1.1.5.gem[m
	[32mnew file:   vendor/cache/domain_name-0.5.20170404.gem[m
	[32mnew file:   vendor/cache/http-cookie-1.0.3.gem[m
	[32mnew file:   vendor/cache/iconv-1.0.4.gem[m
	[32mnew file:   vendor/cache/json-2.1.0.gem[m
	[32mnew file:   vendor/cache/mime-types-3.1.gem[m
	[32mnew file:   vendor/cache/mime-types-data-3.2016.0521.gem[m
	[32mnew file:   vendor/cache/mini_portile2-2.2.0.gem[m
	[32mnew file:   vendor/cache/netrc-0.11.0.gem[m
	[32mnew file:   vendor/cache/nokogiri-1.8.0.gem[m
	[32mnew file:   vendor/cache/passenger-5.1.8.gem[m
	[32mnew file:   vendor/cache/rake-0.9.2.2.gem[m
	[32mnew file:   vendor/cache/rest-client-2.0.2.gem[m
	[32mnew file:   vendor/cache/rmagick-2.16.0.gem[m
	[32mnew file:   vendor/cache/rqrcode-0.10.1.gem[m
	[32mnew file:   vendor/cache/simplecov-0.15.0.gem[m
	[32mnew file:   vendor/cache/simplecov-html-0.10.2.gem[m
	[32mnew file:   vendor/cache/unf-0.1.4.gem[m
	[32mnew file:   vendor/cache/unf_ext-0.0.7.4.gem[m

Changes not staged for commit:
  (use "git add/rm <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	[31mdeleted:    lib/tasks/rspec.rake[m
	[31mdeleted:    vendor/cache/barby-0.5.0.gem[m
	[31mdeleted:    vendor/cache/daemon_controller-1.2.0.gem[m
	[31mdeleted:    vendor/cache/json-1.8.1.gem[m
	[31mdeleted:    vendor/cache/mime-types-1.25.1.gem[m
	[31mdeleted:    vendor/cache/nokogiri-1.5.6.gem[m
	[31mdeleted:    vendor/cache/passenger-4.0.48.gem[m
	[31mdeleted:    vendor/cache/rake-10.3.2.gem[m
	[31mdeleted:    vendor/cache/rcov-1.0.0.gem[m
	[31mdeleted:    vendor/cache/rest-client-1.6.7.gem[m
	[31mdeleted:    vendor/cache/rmagick-2.13.2.gem[m
	[31mdeleted:    vendor/cache/rqrcode-0.4.2.gem[m

]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git commit -am "dde_integration[C3_integration[C[C[C[C[C[C[C[C[C[C[C[C"
[dde_integration a78562a] dde3_integration
 126 files changed, 25445 insertions(+), 195 deletions(-)
 create mode 100644 .ruby-version
 create mode 100644 config/initializers/dde3_user.rb
 create mode 100644 console
 create mode 100644 lib/dde3_service.rb
 delete mode 100644 lib/tasks/rspec.rake
 create mode 100644 s/README
 create mode 100644 s/Rakefile
 create mode 100644 s/app/controllers/application_controller.rb
 create mode 100644 s/app/helpers/application_helper.rb
 create mode 100644 s/config/boot.rb
 create mode 100644 s/config/environment.rb
 create mode 100644 s/config/environments/development.rb
 create mode 100644 s/config/environments/production.rb
 create mode 100644 s/config/environments/test.rb
 create mode 100644 s/config/initializers/backtrace_silencers.rb
 create mode 100644 s/config/initializers/inflections.rb
 create mode 100644 s/config/initializers/mime_types.rb
 create mode 100644 s/config/initializers/new_rails_defaults.rb
 create mode 100644 s/config/initializers/session_store.rb
 create mode 100644 s/config/routes.rb
 create mode 100644 s/db/seeds.rb
 create mode 100644 s/public/404.html
 create mode 100644 s/public/422.html
 create mode 100644 s/public/500.html
 create mode 100644 s/public/favicon.ico
 create mode 100644 s/public/images/rails.png
 create mode 100644 s/public/index.html
 create mode 100644 s/public/javascripts/application.js
 create mode 100644 s/public/javascripts/controls.js
 create mode 100644 s/public/javascripts/dragdrop.js
 create mode 100644 s/public/javascripts/effects.js
 create mode 100644 s/public/javascripts/prototype.js
 create mode 100644 s/public/robots.txt
 create mode 100755 s/script/about
 create mode 100755 s/script/console
 create mode 100755 s/script/dbconsole
 create mode 100755 s/script/destroy
 create mode 100755 s/script/generate
 create mode 100755 s/script/performance/benchmarker
 create mode 100755 s/script/performance/profiler
 create mode 100755 s/script/plugin
 create mode 100755 s/script/runner
 create mode 100755 s/script/server
 create mode 100644 s/test/performance/browsing_test.rb
 create mode 100644 s/test/test_helper.rb
 create mode 100644 server
 create mode 100644 start/README
 create mode 100644 start/Rakefile
 create mode 100644 start/app/controllers/application_controller.rb
 create mode 100644 start/app/helpers/application_helper.rb
 create mode 100644 start/config/boot.rb
 create mode 100644 start/config/environment.rb
 create mode 100644 start/config/environments/development.rb
 create mode 100644 start/config/environments/production.rb
 create mode 100644 start/config/environments/test.rb
 create mode 100644 start/config/initializers/backtrace_silencers.rb
 create mode 100644 start/config/initializers/inflections.rb
 create mode 100644 start/config/initializers/mime_types.rb
 create mode 100644 start/config/initializers/new_rails_defaults.rb
 create mode 100644 start/config/initializers/session_store.rb
 create mode 100644 start/config/routes.rb
 create mode 100644 start/db/seeds.rb
 create mode 100644 start/public/404.html
 create mode 100644 start/public/422.html
 create mode 100644 start/public/500.html
 create mode 100644 start/public/favicon.ico
 create mode 100644 start/public/images/rails.png
 create mode 100644 start/public/index.html
 create mode 100644 start/public/javascripts/application.js
 create mode 100644 start/public/javascripts/controls.js
 create mode 100644 start/public/javascripts/dragdrop.js
 create mode 100644 start/public/javascripts/effects.js
 create mode 100644 start/public/javascripts/prototype.js
 create mode 100644 start/public/robots.txt
 create mode 100755 start/script/about
 create mode 100755 start/script/console
 create mode 100755 start/script/dbconsole
 create mode 100755 start/script/destroy
 create mode 100755 start/script/generate
 create mode 100755 start/script/performance/benchmarker
 create mode 100755 start/script/performance/profiler
 create mode 100755 start/script/plugin
 create mode 100755 start/script/runner
 create mode 100755 start/script/server
 create mode 100644 start/test/performance/browsing_test.rb
 create mode 100644 start/test/test_helper.rb
 delete mode 100755 vendor/cache/barby-0.5.0.gem
 create mode 100644 vendor/cache/barby-0.6.5.gem
 create mode 100644 vendor/cache/chunky_png-1.3.8.gem
 delete mode 100644 vendor/cache/daemon_controller-1.2.0.gem
 create mode 100644 vendor/cache/docile-1.1.5.gem
 create mode 100644 vendor/cache/domain_name-0.5.20170404.gem
 create mode 100644 vendor/cache/http-cookie-1.0.3.gem
 create mode 100644 vendor/cache/iconv-1.0.4.gem
 delete mode 100644 vendor/cache/json-1.8.1.gem
 create mode 100644 vendor/cache/json-2.1.0.gem
 delete mode 100644 vendor/cache/mime-types-1.25.1.gem
 create mode 100644 vendor/cache/mime-types-3.1.gem
 create mode 100644 vendor/cache/mime-types-data-3.2016.0521.gem
 create mode 100644 vendor/cache/mini_portile2-2.2.0.gem
 create mode 100644 vendor/cache/netrc-0.11.0.gem
 delete mode 100644 vendor/cache/nokogiri-1.5.6.gem
 create mode 100644 vendor/cache/nokogiri-1.8.0.gem
 delete mode 100644 vendor/cache/passenger-4.0.48.gem
 create mode 100644 vendor/cache/passenger-5.1.8.gem
 create mode 100644 vendor/cache/rake-0.9.2.2.gem
 delete mode 100644 vendor/cache/rake-10.3.2.gem
 delete mode 100644 vendor/cache/rcov-1.0.0.gem
 delete mode 100644 vendor/cache/rest-client-1.6.7.gem
 create mode 100644 vendor/cache/rest-client-2.0.2.gem
 delete mode 100644 vendor/cache/rmagick-2.13.2.gem
 create mode 100644 vendor/cache/rmagick-2.16.0.gem
 create mode 100644 vendor/cache/rqrcode-0.10.1.gem
 delete mode 100755 vendor/cache/rqrcode-0.4.2.gem
 create mode 100644 vendor/cache/simplecov-0.15.0.gem
 create mode 100644 vendor/cache/simplecov-html-0.10.2.gem
 create mode 100755 vendor/cache/unf-0.1.4.gem
 create mode 100644 vendor/cache/unf_ext-0.0.7.4.gem
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git status
On branch dde_integration
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git checkout -- <file>..." to discard changes in working directory)

	[31mmodified:   console[m

no changes added to commit (use "git add" and/or "git commit -a")
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git add .
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git status
On branch dde_integration
Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)

	[32mmodified:   console[m

]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git commit -am "added changes"
[dde_integration 98fa3cb] added changes
 1 file changed, 83 insertions(+), 1 deletion(-)
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git status
On branch dde_integration
nothing to commit, working directory clean
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git push origin dde_integration
Counting objects: 173, done.
Delta compression using up to 8 threads.
Compressing objects:   1% (1/94)   Compressing objects:   2% (2/94)   Compressing objects:   3% (3/94)   Compressing objects:   4% (4/94)   Compressing objects:   5% (5/94)   Compressing objects:   6% (6/94)   Compressing objects:   7% (7/94)   Compressing objects:   8% (8/94)   Compressing objects:   9% (9/94)   Compressing objects:  10% (10/94)   Compressing objects:  11% (11/94)   Compressing objects:  12% (12/94)   Compressing objects:  13% (13/94)   Compressing objects:  14% (14/94)   Compressing objects:  15% (15/94)   Compressing objects:  17% (16/94)   Compressing objects:  18% (17/94)   Compressing objects:  19% (18/94)   Compressing objects:  20% (19/94)   Compressing objects:  21% (20/94)   Compressing objects:  22% (21/94)   Compressing objects:  23% (22/94)   Compressing objects:  24% (23/94)   Compressing objects:  25% (24/94)   Compressing objects:  26% (25/94)   Compressing objects:  27% (26/94)   Compressing objects:  28% (27/94)   Compressing objects:  29% (28/94)   Compressing objects:  30% (29/94)   Compressing objects:  31% (30/94)   Compressing objects:  32% (31/94)   Compressing objects:  34% (32/94)   Compressing objects:  35% (33/94)   Compressing objects:  36% (34/94)   Compressing objects:  37% (35/94)   Compressing objects:  38% (36/94)   Compressing objects:  39% (37/94)   Compressing objects:  40% (38/94)   Compressing objects:  41% (39/94)   Compressing objects:  42% (40/94)   Compressing objects:  43% (41/94)   Compressing objects:  44% (42/94)   Compressing objects:  45% (43/94)   Compressing objects:  46% (44/94)   Compressing objects:  47% (45/94)   Compressing objects:  48% (46/94)   Compressing objects:  50% (47/94)   Compressing objects:  51% (48/94)   Compressing objects:  52% (49/94)   Compressing objects:  53% (50/94)   Compressing objects:  54% (51/94)   Compressing objects:  55% (52/94)   Compressing objects:  56% (53/94)   Compressing objects:  57% (54/94)   Compressing objects:  58% (55/94)   Compressing objects:  59% (56/94)   Compressing objects:  60% (57/94)   Compressing objects:  61% (58/94)   Compressing objects:  62% (59/94)   Compressing objects:  63% (60/94)   Compressing objects:  64% (61/94)   Compressing objects:  65% (62/94)   Compressing objects:  67% (63/94)   Compressing objects:  68% (64/94)   Compressing objects:  69% (65/94)   Compressing objects:  70% (66/94)   Compressing objects:  71% (67/94)   Compressing objects:  72% (68/94)   Compressing objects:  73% (69/94)   Compressing objects:  74% (70/94)   Compressing objects:  75% (71/94)   Compressing objects:  76% (72/94)   Compressing objects:  77% (73/94)   Compressing objects:  78% (74/94)   Compressing objects:  79% (75/94)   Compressing objects:  80% (76/94)   Compressing objects:  81% (77/94)   Compressing objects:  82% (78/94)   Compressing objects:  84% (79/94)   Compressing objects:  85% (80/94)   Compressing objects:  86% (81/94)   Compressing objects:  87% (82/94)   Compressing objects:  88% (83/94)   Compressing objects:  89% (84/94)   Compressing objects:  90% (85/94)   Compressing objects:  91% (86/94)   Compressing objects:  92% (87/94)   Compressing objects:  93% (88/94)   Compressing objects:  94% (89/94)   Compressing objects:  95% (90/94)   Compressing objects:  96% (91/94)   Compressing objects:  97% (92/94)   Compressing objects:  98% (93/94)   Compressing objects: 100% (94/94)   Compressing objects: 100% (94/94), done.
Writing objects:   0% (1/102)   Writing objects:   1% (2/102)   Writing objects:   2% (3/102)   Writing objects:   3% (4/102)   Writing objects:   4% (5/102)   Writing objects:   5% (6/102)   Writing objects:   6% (7/102)   Writing objects:   7% (8/102)   Writing objects:   8% (9/102)   Writing objects:   9% (10/102)   Writing objects:  10% (11/102)   Writing objects:  11% (12/102)   Writing objects:  12% (13/102)   Writing objects:  13% (14/102)   Writing objects:  14% (15/102)   Writing objects:  15% (16/102)   Writing objects:  16% (17/102)   Writing objects:  17% (18/102)   Writing objects:  18% (19/102)   Writing objects:  19% (20/102)   Writing objects:  20% (21/102)   Writing objects:  21% (22/102)   Writing objects:  22% (23/102)   Writing objects:  23% (24/102)   Writing objects:  24% (25/102)   Writing objects:  25% (26/102)   Writing objects:  26% (27/102)   Writing objects:  27% (28/102)   Writing objects:  28% (29/102)   Writing objects:  29% (30/102)   Writing objects:  30% (31/102)   Writing objects:  31% (32/102)   Writing objects:  32% (33/102)   Writing objects:  34% (35/102)   Writing objects:  35% (36/102)   Writing objects:  36% (37/102)   Writing objects:  37% (38/102)   Writing objects:  38% (39/102)   Writing objects:  39% (40/102)   Writing objects:  40% (41/102)   Writing objects:  41% (42/102)   Writing objects:  42% (43/102)   Writing objects:  43% (44/102)   Writing objects:  44% (45/102)   Writing objects:  45% (46/102)   Writing objects:  47% (48/102)   Writing objects:  48% (49/102)   Writing objects:  49% (50/102)   Writing objects:  50% (51/102)   Writing objects:  51% (53/102)   Writing objects:  52% (54/102)   Writing objects:  53% (55/102)   Writing objects:  54% (56/102)   Writing objects:  55% (57/102)   Writing objects:  56% (58/102)   Writing objects:  57% (59/102)   Writing objects:  58% (60/102)   Writing objects:  59% (61/102)   Writing objects:  60% (62/102)   Writing objects:  62% (64/102)   Writing objects:  63% (65/102)   Writing objects:  64% (66/102)   Writing objects:  65% (67/102)   Writing objects:  66% (68/102)   Writing objects:  67% (69/102)   Writing objects:  68% (70/102)   Writing objects:  69% (71/102)   Writing objects:  70% (72/102)   Writing objects:  71% (73/102)   Writing objects:  72% (74/102)   Writing objects:  73% (75/102)   Writing objects:  74% (76/102)   Writing objects:  75% (77/102)   Writing objects:  76% (78/102)   Writing objects:  77% (79/102)   Writing objects:  78% (80/102)   Writing objects:  79% (81/102)   Writing objects:  80% (82/102)   Writing objects:  81% (83/102)   Writing objects:  82% (84/102)   Writing objects:  83% (85/102)   Writing objects:  84% (86/102)   Writing objects:  85% (87/102)   Writing objects:  86% (88/102)   Writing objects:  87% (89/102)   Writing objects:  88% (90/102)   Writing objects:  89% (91/102)   Writing objects:  89% (91/102), 1.30 MiB | 214.00 KiB/s   Writing objects:  89% (91/102), 1.94 MiB | 122.00 KiB/s   Writing objects:  89% (91/102), 2.57 MiB | 59.00 KiB/s   Writing objects:  89% (91/102), 3.20 MiB | 57.00 KiB/s   Writing objects:  89% (91/102), 3.84 MiB | 54.00 KiB/s   Writing objects:  89% (91/102), 4.47 MiB | 53.00 KiB/s   Writing objects:  89% (91/102), 5.10 MiB | 59.00 KiB/s   Writing objects:  89% (91/102), 5.73 MiB | 49.00 KiB/s   Writing objects:  89% (91/102), 6.35 MiB | 54.00 KiB/s   Writing objects:  89% (91/102), 6.97 MiB | 47.00 KiB/s   Writing objects:  89% (91/102), 7.58 MiB | 47.00 KiB/s   Writing objects:  89% (91/102), 8.21 MiB | 53.00 KiB/s   Writing objects:  89% (91/102), 8.84 MiB | 50.00 KiB/s   Writing objects:  89% (91/102), 9.48 MiB | 57.00 KiB/s   Writing objects:  90% (92/102), 9.48 MiB | 57.00 KiB/s   Writing objects:  90% (92/102), 10.10 MiB | 60.00 KiB/s   Writing objects:  90% (92/102), 10.73 MiB | 60.00 KiB/s   Writing objects:  90% (92/102), 11.34 MiB | 76.00 KiB/s   Writing objects:  90% (92/102), 11.97 MiB | 75.00 KiB/s   Writing objects:  90% (92/102), 12.59 MiB | 67.00 KiB/s   Writing objects:  90% (92/102), 13.21 MiB | 75.00 KiB/s   Writing objects:  90% (92/102), 13.83 MiB | 83.00 KiB/s   Writing objects:  90% (92/102), 14.45 MiB | 96.00 KiB/s   Writing objects:  91% (93/102), 14.45 MiB | 96.00 KiB/s   Writing objects:  92% (94/102), 14.45 MiB | 96.00 KiB/s   Writing objects:  92% (94/102), 15.08 MiB | 87.00 KiB/s   Writing objects:  92% (94/102), 15.70 MiB | 90.00 KiB/s   Writing objects:  93% (95/102), 15.70 MiB | 90.00 KiB/s   Writing objects:  94% (96/102), 15.70 MiB | 90.00 KiB/s   Writing objects:  95% (97/102), 15.70 MiB | 90.00 KiB/s   Writing objects:  95% (97/102), 16.32 MiB | 81.00 KiB/s   Writing objects:  96% (98/102), 16.32 MiB | 81.00 KiB/s   Writing objects:  97% (99/102), 16.32 MiB | 81.00 KiB/s   Writing objects:  98% (100/102), 16.32 MiB | 81.00 KiB/s   Writing objects:  99% (101/102), 16.32 MiB | 81.00 KiB/s   Writing objects: 100% (102/102), 16.32 MiB | 81.00 KiB/s   Writing objects: 100% (102/102), 16.73 MiB | 84.00 KiB/s, done.
Total 102 (delta 33), reused 8 (delta 2)
remote: Resolving deltas:   0% (0/33)   [Kremote: Resolving deltas:   3% (1/33)   [Kremote: Resolving deltas:   6% (2/33)   [Kremote: Resolving deltas:   9% (3/33)   [Kremote: Resolving deltas:  12% (4/33)   [Kremote: Resolving deltas:  18% (6/33)   [Kremote: Resolving deltas:  24% (8/33)   [Kremote: Resolving deltas:  39% (13/33)   [Kremote: Resolving deltas:  45% (15/33)   [Kremote: Resolving deltas:  48% (16/33)   [Kremote: Resolving deltas:  54% (18/33)   [Kremote: Resolving deltas:  57% (19/33)   [Kremote: Resolving deltas:  60% (20/33)   [Kremote: Resolving deltas:  63% (21/33)   [Kremote: Resolving deltas:  66% (22/33)   [Kremote: Resolving deltas:  72% (24/33)   [Kremote: Resolving deltas:  75% (25/33)   [Kremote: Resolving deltas:  78% (26/33)   [Kremote: Resolving deltas:  81% (27/33)   [Kremote: Resolving deltas:  84% (28/33)   [Kremote: Resolving deltas:  87% (29/33)   [Kremote: Resolving deltas:  90% (30/33)   [Kremote: Resolving deltas:  93% (31/33)   [Kremote: Resolving deltas:  96% (32/33)   [Kremote: Resolving deltas: 100% (33/33)   [Kremote: Resolving deltas: 100% (33/33), completed with 17 local objects.[K
To git@github.com:BaobabHealthTrust/Maternity.git
 * [new branch]      dde_integration -> dde_integration
]0;taona@mango: /var/www/Maternitytaona@mango:/var/www/Maternity$ git push origin dde_integrationstatus[Kcommit -am "added changes"status[K[1Padd .statuscommit -am "dde3_integration"status[K[1Padd .statusbranchscript/server
=> Booting WEBrick
=> Rails 2.3.5 application starting on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
[2017-09-14 09:41:56] INFO  WEBrick 1.3.1
[2017-09-14 09:41:56] INFO  ruby 1.8.7 (2013-06-27) [x86_64-linux]
[2017-09-14 09:41:56] INFO  WEBrick::HTTPServer#start: pid=17353 port=3000
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#overview (for 127.0.0.1 at 2017-09-14 09:56:44) [GET]
  Parameters: {"action"=>"overview", "controller"=>"people"}
  [4;35;1mUser Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.1ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.5ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mGlobalProperty Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `global_property`[0m
  [4;36;1mGlobalProperty Load (0.1ms)[0m   [0;1mSELECT * FROM `global_property` WHERE (`global_property`.`property` = 'statistics.show_encounter_types') LIMIT 1[0m
  [4;35;1mEncounterType Load (0.1ms)[0m   [0mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;36;1mEncounterType Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `encounter_type`[0m
  [4;35;1mEncounter Load (12.4ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.creator = 8 AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (67.6ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (DATE(encounter_datetime) = DATE(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (66.2ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (YEAR(encounter_datetime) = YEAR(NOW()) AND encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mCACHE (0.0ms)[0m   [0;1mSELECT * FROM `encounter_type` WHERE (name IN ('REGISTRATION')) [0m
  [4;35;1mEncounter Load (0.1ms)[0m   [0mSELECT count(*) as number, encounter_type FROM `encounter` WHERE (encounter_type IN (5)) AND (encounter.location_id = 746) GROUP BY encounter.encounter_type[0m
  [4;36;1mEncounter Columns (0.4ms)[0m   [0;1mSHOW FIELDS FROM `encounter`[0m
Rendering people/overview
Completed in 211ms (View: 4, DB: 149) | 200 OK [http://localhost/people/overview]
  [4;35;1mSQL (0.0ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#admin (for 127.0.0.1 at 2017-09-14 09:56:45) [GET]
  Parameters: {"action"=>"admin", "controller"=>"people"}
  [4;36;1mUser Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `users`[0m
  [4;35;1mUser Load (0.0ms)[0m   [0mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;36;1mLocation Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `location`[0m
  [4;35;1mLocation Load (0.1ms)[0m   [0mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
Rendering people/admin
Completed in 15ms (View: 2, DB: 1) | 200 OK [http://localhost/people/admin]
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m


Processing PeopleController#search (for 127.0.0.1 at 2017-09-14 09:56:47) [GET]
  Parameters: {"action"=>"search", "gender"=>"F", "cat"=>"mother", "controller"=>"people"}
  [4;35;1mUser Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `users`[0m
  [4;36;1mUser Load (0.0ms)[0m   [0;1mSELECT * FROM `users` WHERE (`users`.`user_id` = 8) LIMIT 1[0m
  [4;35;1mLocation Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `location`[0m
  [4;36;1mLocation Load (0.1ms)[0m   [0;1mSELECT * FROM `location` WHERE (`location`.`location_id` = 746) LIMIT 1[0m
  [4;35;1mRelationshipType Columns (0.4ms)[0m   [0mSHOW FIELDS FROM `relationship_type`[0m
  [4;36;1mRelationshipType Load (0.1ms)[0m   [0;1mSELECT * FROM `relationship_type` WHERE (`relationship_type`.`a_is_to_b` = 'Mother') ORDER BY weight DESC LIMIT 1[0m
  [4;35;1mPerson Columns (0.3ms)[0m   [0mSHOW FIELDS FROM `person`[0m
  [4;36;1mPersonName Columns (0.3ms)[0m   [0;1mSHOW FIELDS FROM `person_name`[0m
  [4;35;1mPersonNameCode Columns (0.2ms)[0m   [0mSHOW FIELDS FROM `person_name_code`[0m
  [4;36;1mPatient Columns (0.2ms)[0m   [0;1mSHOW FIELDS FROM `patient`[0m
  [4;35;1mPerson Load Including Associations (0.1ms)[0m   [0mSELECT `person`.`person_id` AS t0_r0, `person`.`gender` AS t0_r1, `person`.`birthdate` AS t0_r2, `person`.`birthdate_estimated` AS t0_r3, `person`.`dead` AS t0_r4, `person`.`death_date` AS t0_r5, `person`.`cause_of_death` AS t0_r6, `person`.`creator` AS t0_r7, `person`.`date_created` AS t0_r8, `person`.`changed_by` AS t0_r9, `person`.`date_changed` AS t0_r10, `person`.`voided` AS t0_r11, `person`.`voided_by` AS t0_r12, `person`.`date_voided` AS t0_r13, `person`.`void_reason` AS t0_r14, `person_name`.`person_name_id` AS t1_r0, `person_name`.`preferred` AS t1_r1, `person_name`.`person_id` AS t1_r2, `person_name`.`prefix` AS t1_r3, `person_name`.`given_name` AS t1_r4, `person_name`.`middle_name` AS t1_r5, `person_name`.`family_name_prefix` AS t1_r6, `person_name`.`family_name` AS t1_r7, `person_name`.`family_name2` AS t1_r8, `person_name`.`family_name_suffix` AS t1_r9, `person_name`.`degree` AS t1_r10, `person_name`.`creator` AS t1_r11, `person_name`.`date_created` AS t1_r12, `person_name`.`voided` AS t1_r13, `person_name`.`voided_by` AS t1_r14, `person_name`.`date_voided` AS t1_r15, `person_name`.`void_reason` AS t1_r16, `person_name`.`changed_by` AS t1_r17, `person_name`.`date_changed` AS t1_r18, `person_name_code`.`person_name_code_id` AS t2_r0, `person_name_code`.`person_name_id` AS t2_r1, `person_name_code`.`given_name_code` AS t2_r2, `person_name_code`.`middle_name_code` AS t2_r3, `person_name_code`.`family_name_code` AS t2_r4, `person_name_code`.`family_name2_code` AS t2_r5, `person_name_code`.`family_name_suffix_code` AS t2_r6, `patient`.`patient_id` AS t3_r0, `patient`.`tribe` AS t3_r1, `patient`.`creator` AS t3_r2, `patient`.`date_created` AS t3_r3, `patient`.`changed_by` AS t3_r4, `patient`.`date_changed` AS t3_r5, `patient`.`voided` AS t3_r6, `patient`.`voided_by` AS t3_r7, `patient`.`date_voided` AS t3_r8, `patient`.`void_reason` AS t3_r9 FROM `person` LEFT OUTER JOIN `person_name` ON person_name.person_id = person.person_id AND person_name.voided = 0 LEFT OUTER JOIN `person_name_code` ON person_n